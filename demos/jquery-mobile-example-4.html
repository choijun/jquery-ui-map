<!DOCTYPE html> 
<html> 
	<head> 
		<title>Google maps - jQuery mobile with jQuery UI Google maps v3 plugin</title>
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.css" />
		<style rel="stylesheet">
			body {  background: #ddd; }
			body, #gmap-4, .page, #map_canvas_2 { height:100%; }
			.ui-content { padding:0; }
			.hidden { display:none; }
		</style>
		<script src="http://www.google.com/jsapi?key=ABQIAAAAahcO7noe62FuOIQacCQQ7RTHkUDJMJAZieEeKAqNDtpKxMhoFxQsdtJdv3FJ1dT3WugUNJb7xD-jsQ" type="text/javascript"></script>        
        <script type="text/javascript">
			google.load("maps", "3", {'other_params':'sensor=true'});
			google.load("jquery", "1.5");
		</script>
		<script type="text/javascript">
			// Demonstration purpose only...
			$(document).bind("mobileinit", function () {
				$.mobile.ajaxEnabled  = true;
			});
		</script>
		<script type="text/javascript" src="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.js"></script>
		<script type="text/javascript" src="../ui/jquery.ui.map.js"></script>
	</head> 

	<body> 

		<div id="gmap-4" class="" data-role="page">

			<div data-role="header">
				<h1><a href="http://code.google.com/p/jquery-ui-map/">jQuery mobile with Google maps v3</a> demo</h1>
			</div>

			<script type="text/javascript">
				$('#gmap-4').live("pageshow", function() {
					
					$('#map_canvas_2').gmap( { 'center': getLatLng(), 'callback': 
						function (map) {
							if ( navigator.geolocation ) {
								watch = navigator.geolocation.watchPosition ( 
									function( position ) { 
										$('#map_canvas_2').gmap('clearMarkers');
										$('#map_canvas_2').gmap('addMarker', { 'title': 'You are here!', 'bound': true, 'position':new google.maps.LatLng(position.coords.latitude, position.coords.longitude) }, function(map, marker) {
											$('#map_canvas_2').gmap('addInfoWindow', { 'position': marker.getPosition(), 'content': 'You are here!' }, function(iw) {
												$(marker).click(function() {
													iw.open(map, marker);
												});
											});
											map.panTo( marker.getPosition() );
										});
									}
								);
							}
						}
					}); 
					
					function getLatLng() {
						if ( google.loader.ClientLocation != null ) {
							return new google.maps.LatLng(google.loader.ClientLocation.latitude, google.loader.ClientLocation.longitude);	
						}
						return new google.maps.LatLng(59.3426606750, 18.0736160278);
					}

				});
				
				$('#gmap-4').live("pagehide", function() {
					if ( navigator.geolocation ) {
						navigator.geolocation.clearWatch(watch);
                    }
				});
				
				$('#gmap-4').live("pagecreate", function() {
					var watch;
				});

			</script>
			<div class="page" data-role="content">
				
				<div id="map_canvas_2"></div>
								
            </div>

			<div id="ft" class="hidden" itemscope itemtype="http://data-vocabulary.org/Person">
				Author: 
				<span itemprop="name">Johan S&auml;ll Larsson</span>  
				<span itemprop="address" itemscope itemtype="http://data-vocabulary.org/Address">
					<span itemprop="locality">G&ouml;teborg</span>, 
					<span itemprop="country-name">Sweden</span> 
				</span>
			</div>
			
		</div>

	</body>
	
</html>